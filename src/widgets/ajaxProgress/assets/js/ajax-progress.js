// Generated by CoffeeScript 2.3.2
(function() {
  var Plugin, defaults, pluginName;

  (function($, window, document) {})(jQuery, window, document);

  pluginName = "ajaxProgress";

  defaults = {
    statusUrl: null,
    endStatus: 'stopped',
    refreshRate: 1000,
    onComplete: null
  };

  Plugin = class Plugin {
    constructor(element, options) {
      this.element = element;
      this.settings = $.extend({}, defaults, options);
      this._defaults = defaults;
      this._name = pluginName;
      this.init();
    }

    init() {
      return this.enableAjax();
    }

    enableAjax() {
      var id, onComplete, progressBar, statusUrl;
      progressBar = $(this.element);
      statusUrl = this.settings.statusUrl;
      onComplete = this.settings.onComplete;
      return id = setInterval(function() {
        return $.ajax(statusUrl, {
          success: function(data, textStatus, jqXHR) {
            var progress;
            progress = parseInt(data.progress);
            progressBar.html(data.statusMessage + ' ' + progress.toPrecision(3) + '%');
            progressBar.css({
              width: progress + '%'
            });
            if (progress === 100) {
              progressBar.removeClass('progress-bar-info');
              progressBar.addClass('progress-bar-success');
              progressBar.parent("div").removeClass('progress-striped');
              clearInterval(id);
              return progressBar.trigger('complete');
            }
          }
        });
      }, this.settings.refreshRate);
    }

  };

  $.fn[pluginName] = function(options) {
    return this.each(function() {
      if (!$.data(this, `plugin_${pluginName}`)) {
        return $.data(this, `plugin_${pluginName}`, new Plugin(this, options));
      }
    });
  };

}).call(this);

//# sourceMappingURL=ajax-progress.js.map
